<!--
  ~ Copyright (C) 2017/2021 e-voyageurs technologies
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<nb-card class="runtime-settings">
  <nb-card-header style="position: relative; display: flex">
    <span>Tagged Stories</span>
    <tock-info-button
      message="Stories configured by tags."
      url="http://doc.tock.ai/tock"
    ></tock-info-button>
  </nb-card-header>
  <nb-card-body>
    <nb-card>
      <nb-card-header style="position: relative">
        <nb-badge
          [text]="taggedStoriesCount | i18nPlural: storyPluralMapping['story']"
          [status]="taggedStoriesCount < 1 ? 'success' : 'info'"
          position="top left"
        ></nb-badge>
        <span>Tagged Stories</span>
      </nb-card-header>
      <nb-card-body>
        <div style="display: flex">
          <tock-info-button
            message="Stories used to disable the bot."
            position="inline"
          ></tock-info-button>
          <div *ngIf="!disableStories || disableStories.length < 1">
            <p>No story tagged to disable the bot.</p>
          </div>
          <div *ngIf="disableStories && disableStories.length > 0">
            <div
              *ngFor="let story of disableStories"
              class="deactivation-story"
            >
              <div [nbTooltip]="'Story: ' + story.name">
                <nb-icon
                  *ngIf="story.isBuiltIn()"
                  class="story-type"
                  icon="cube"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isSimpleAnswer()"
                  class="story-type"
                  icon="message-square-outline"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isScriptAnswer()"
                  class="story-type"
                  icon="code"
                ></nb-icon>
                {{ story.name }}
              </div>
            </div>
          </div>
        </div>
        <div style="display: flex">
          <tock-info-button
            message="Stories used to enable the bot."
            position="inline"
          ></tock-info-button>
          <div *ngIf="!enableStories || enableStories.length < 1">
            <p>No story tagged to enable the bot.</p>
          </div>
          <div *ngIf="enableStories && enableStories.length > 0">
            <div
              *ngFor="let story of enableStories"
              class="deactivation-story"
            >
              <div [nbTooltip]="'Story: ' + story.name">
                <nb-icon
                  *ngIf="story.isBuiltIn()"
                  class="story-type"
                  icon="cube"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isSimpleAnswer()"
                  class="story-type"
                  icon="message-square-outline"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isScriptAnswer()"
                  class="story-type"
                  icon="code"
                ></nb-icon>
                {{ story.name }}
              </div>
            </div>
          </div>
        </div>
        <div style="display: flex">
          <tock-info-button
            message="Only sub steps entities are checked to decide if the user stays in the same story."
            position="inline"
          ></tock-info-button>
          <div *ngIf="!checkOnlySubEntitiesForStorySelection || checkOnlySubEntitiesForStorySelection.length < 1">
            <p>No story tagged in order that only sub actions entities are checked for action selection (and not the whole tree).</p>
          </div>
          <div *ngIf="checkOnlySubEntitiesForStorySelection && checkOnlySubEntitiesForStorySelection.length > 0">
            <div
              *ngFor="let story of checkOnlySubEntitiesForStorySelection"
              class="deactivation-story"
            >
              <div [nbTooltip]="'Story: ' + story.name">
                <nb-icon
                  *ngIf="story.isBuiltIn()"
                  class="story-type"
                  icon="cube"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isSimpleAnswer()"
                  class="story-type"
                  icon="message-square-outline"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isScriptAnswer()"
                  class="story-type"
                  icon="code"
                ></nb-icon>
                {{ story.name }}
              </div>
            </div>
          </div>
        </div>
        <div style="display: flex">
          <tock-info-button
            message="Only intents supported by the story are checked for entity action selection."
            position="inline"
          ></tock-info-button>
          <div *ngIf="!checkSubEntitiesOnlyWithStoryIntents || checkSubEntitiesOnlyWithStoryIntents.length < 1">
            <p>No story tagged in order that only intents supported by the story are checked for entity action selection.</p>
          </div>
          <div *ngIf="checkSubEntitiesOnlyWithStoryIntents && checkSubEntitiesOnlyWithStoryIntents.length > 0">
            <div
              *ngFor="let story of checkSubEntitiesOnlyWithStoryIntents"
              class="deactivation-story"
            >
              <div [nbTooltip]="'Story: ' + story.name">
                <nb-icon
                  *ngIf="story.isBuiltIn()"
                  class="story-type"
                  icon="cube"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isSimpleAnswer()"
                  class="story-type"
                  icon="message-square-outline"
                ></nb-icon>
                <nb-icon
                  *ngIf="story.isScriptAnswer()"
                  class="story-type"
                  icon="code"
                ></nb-icon>
                {{ story.name }}
              </div>
            </div>
          </div>
        </div>
      </nb-card-body>
    </nb-card>
  </nb-card-body>
</nb-card>





<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Pour construire aisément vos prochains bots">
      
      
        <link rel="canonical" href="https://voyages-sncf-technologies.github.io/tock/fr/guide/api/">
      
      
        <meta name="author" content="VSCT">
      
      
        <meta name="lang:clipboard.copy" content="Copier dans le presse-papier">
      
        <meta name="lang:clipboard.copied" content="Copié dans le presse-papier">
      
        <meta name="lang:search.language" content="fr">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="Aucun document trouvé">
      
        <meta name="lang:search.result.one" content="1 document trouvé">
      
        <meta name="lang:search.result.other" content="# documents trouvés">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Programmer des parcours - Tock</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#programmer-des-parcours-en-kotlin" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://voyages-sncf-technologies.github.io/tock/fr" title="Tock" class="md-header-nav__button md-logo">
          
            <img src="../../assets/images/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Tock
            </span>
            <span class="md-header-nav__topic">
              
                Programmer des parcours
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Taper pour démarrer la recherche
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/voyages-sncf-technologies/tock" title="Aller au dépôt" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    tock
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://voyages-sncf-technologies.github.io/tock/fr" title="Tock" class="md-nav__button md-logo">
      
        <img src="../../assets/images/logo.svg" width="48" height="48">
      
    </a>
    Tock
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/voyages-sncf-technologies/tock" title="Aller au dépôt" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    tock
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Vue d`ensemble" class="md-nav__link">
      Vue d`ensemble
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../toc/" title="Table des matières" class="md-nav__link">
      Table des matières
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Découvrir Tock
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Découvrir Tock
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../studio/" title="Créer son premier bot" class="md-nav__link">
      Créer son premier bot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../slack/" title="Configurer Slack" class="md-nav__link">
      Configurer Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../messenger/" title="Configurer Messenger" class="md-nav__link">
      Configurer Messenger
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Programmer des parcours
      </label>
    
    <a href="./" title="Programmer des parcours" class="md-nav__link md-nav__link--active">
      Programmer des parcours
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table des matières</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ce-que-vous-allez-creer" class="md-nav__link">
    Ce que vous allez créer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-requis" class="md-nav__link">
    Pré-requis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creer-un-programme-kotlin-avec-la-dependance-tock" class="md-nav__link">
    Créer un programme Kotlin avec la dépendance Tock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creer-une-fonction-qui-se-connecte-a-tock" class="md-nav__link">
    Créer une fonction qui se connecte à Tock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminer-la-configuration-dans-tock-studio" class="md-nav__link">
    Terminer la configuration dans Tock Studio
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#felicitations" class="md-nav__link">
    Félicitations!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuer" class="md-nav__link">
    Continuer...
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../plateforme/" title="Déployer avec Docker" class="md-nav__link">
      Déployer avec Docker
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Utiliser Tock
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Utiliser Tock
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../utilisateur/concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../utilisateur/studio/" title="Tock Studio" class="md-nav__link">
      Tock Studio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../utilisateur/canaux/" title="Bot multicanal" class="md-nav__link">
      Bot multicanal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../utilisateur/i18n/" title="Bot multilingue" class="md-nav__link">
      Bot multilingue
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Développer avec Tock
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Développer avec Tock
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/modes/" title="Modes disponibles" class="md-nav__link">
      Modes disponibles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/bot-api/" title="Tock Bot API" class="md-nav__link">
      Tock Bot API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/bot-integre/" title="Tock Bot intégré" class="md-nav__link">
      Tock Bot intégré
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/connecteurs/" title="Connecteurs" class="md-nav__link">
      Connecteurs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/i18n/" title="i18n" class="md-nav__link">
      i18n
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/api/" title="Liste des APIs" class="md-nav__link">
      Liste des APIs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/exemples-code/" title="Exemples de code" class="md-nav__link">
      Exemples de code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Administrer Tock
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Administrer Tock
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/securite/" title="Sécurité" class="md-nav__link">
      Sécurité
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/disponibilite/" title="Disponibilité" class="md-nav__link">
      Disponibilité
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/supervision/" title="Supervision" class="md-nav__link">
      Supervision
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/cloud/" title="Cloud" class="md-nav__link">
      Cloud
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      A propos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        A propos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/pourquoi/" title="Pourquoi Tock" class="md-nav__link">
      Pourquoi Tock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/vitrine/" title="Vitrine utilisateurs" class="md-nav__link">
      Vitrine utilisateurs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/ressources/" title="Ressources" class="md-nav__link">
      Ressources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/contact/" title="Nous contacter" class="md-nav__link">
      Nous contacter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/communaute/" title="Communauté" class="md-nav__link">
      Communauté
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/contribuer/" title="Contribuer" class="md-nav__link">
      Contribuer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apropos/emploi/" title="Emploi" class="md-nav__link">
      Emploi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table des matières</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ce-que-vous-allez-creer" class="md-nav__link">
    Ce que vous allez créer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-requis" class="md-nav__link">
    Pré-requis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creer-un-programme-kotlin-avec-la-dependance-tock" class="md-nav__link">
    Créer un programme Kotlin avec la dépendance Tock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creer-une-fonction-qui-se-connecte-a-tock" class="md-nav__link">
    Créer une fonction qui se connecte à Tock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminer-la-configuration-dans-tock-studio" class="md-nav__link">
    Terminer la configuration dans Tock Studio
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#felicitations" class="md-nav__link">
    Félicitations!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuer" class="md-nav__link">
    Continuer...
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="programmer-des-parcours-en-kotlin">Programmer des parcours en Kotlin<a class="headerlink" href="#programmer-des-parcours-en-kotlin" title="Permanent link">&para;</a></h1>
<p>Les interfaces <em>Tock Studio</em> permettent de créer des bots et des parcours relativement simples, comme 
des <em>arbres de décision</em> et des réponses à des questions courantes. Cela s'avère suffisant pour de nombreux cas 
d'usages conversationnels.</p>
<p>Toutefois, il est possible de construire des réponses et des parcours plus complexes :</p>
<ul>
<li>
<p>Se brancher à un compte utilisateur</p>
</li>
<li>
<p>Aggréger les informations de référentiels métier</p>
</li>
<li>
<p>Appeler les services du <em>SI (Système d'Information)</em> dans une organisation</p>
</li>
<li>
<p>Intégrer des API externes pour enrichir ses parcours de services tiers</p>
</li>
<li>
<p>Effectuer des actions et des <em>transactions</em> : création de tickets, paiements, etc.</p>
</li>
<li>
<p>Implémenter des règles de gestion et comportements spécifiques</p>
</li>
<li>
<p>Optimiser les enchaînements entre les intentions</p>
</li>
</ul>
<p>Pour construire des parcours complexes, <em>Tock</em> propose plusieurs modes d'intégration destinés à 
 différents langages et frameworks de développement.</p>
<p>Dans ce guide, vous utiliserez le langage <a href="https://kotlinlang.org/">Kotlin</a> et le mode 
  <em>WebSocket</em> pour ajouter une intention à un bot initié dans <em>Tock Studio</em>.</p>
<p>Si vous le souhaitez, vous pouvez sauter cette étape et <a href="../plateforme/">déployer un plateforme avec Docker</a> 
ou passer directement au <a href="../../toc/">manuel utilisateur</a> pour en savoir plus sur les possibilités de <em>Tock Studio</em>.</p>
<h2 id="ce-que-vous-allez-creer">Ce que vous allez créer<a class="headerlink" href="#ce-que-vous-allez-creer" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Une <em>intention</em> Tock développée avec le langage <a href="https://kotlinlang.org/">Kotlin</a></p>
</li>
<li>
<p>Un programme se connectant au bot en <em>WebSocket</em> pour l'enrichir de parcours programmés</p>
</li>
</ul>
<h2 id="pre-requis">Pré-requis<a class="headerlink" href="#pre-requis" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Environ 10 minutes</p>
</li>
<li>
<p>Un bot Tock fonctionnel (par exemple suite au guide <a href="../studio/">premier bot Tock</a>)</p>
</li>
<li>
<p>Un environnement de développement (ou <em>IDE</em>) supportant <a href="https://kotlinlang.org/">Kotlin</a>, par exemple 
<a href="https://www.jetbrains.com/idea/">IntelliJ</a> avec des versions récentes du <a href="https://jdk.java.net/">JDK</a> 
et de <a href="https://maven.apache.org/">Maven</a></p>
</li>
</ul>
<blockquote>
<p>Si vous ne souhaitez pas utiliser d'<em>IDE</em>, ou Maven, pas de problème. Il est tout à fait possible de réaliser le même 
exercice avec d'autres outils.</p>
<p>Il est également possible d'utiliser d'autres manières de développer que le mode <em>WebSocket</em> et d'autres 
langages que Kotlin. Vous en apprendrez plus dans le <a href="../../toc/">manuel utilisateur Tock</a>.</p>
</blockquote>
<h2 id="creer-un-programme-kotlin-avec-la-dependance-tock">Créer un programme Kotlin avec la dépendance Tock<a class="headerlink" href="#creer-un-programme-kotlin-avec-la-dependance-tock" title="Permanent link">&para;</a></h2>
<p>Il existe de nombreuses manières de créer un projet en Kotlin.</p>
<p>Ajoutez au <em>classpath</em> la bibliothèque <code>tock-bot-api-websocket</code> pour le mode <em>WebSocket</em>.</p>
<p>Si vous utilisez <a href="https://maven.apache.org/">Apache Maven</a>, voici un exemple de <em>POM</em> (<code>pom.xml</code>) pour Kotlin avec 
la dépendance <code>tock-bot-api-websocket</code> incluse :</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

    <span class="nt">&lt;groupId&gt;</span>test<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>tock-kotlin-websocket<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>

    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;project.build.sourceDirectory&gt;</span>${project.basedir}/src/main/kotlin<span class="nt">&lt;/project.build.sourceDirectory&gt;</span>
        <span class="nt">&lt;project.build.testSourceDirectory&gt;</span>${project.basedir}/src/test/kotlin<span class="nt">&lt;/project.build.testSourceDirectory&gt;</span>
        <span class="nt">&lt;lib.tock.version&gt;</span>19.3.3<span class="nt">&lt;/lib.tock.version&gt;</span>
        <span class="nt">&lt;plugin.kotlin.version&gt;</span>1.3.41<span class="nt">&lt;/plugin.kotlin.version&gt;</span>
        <span class="nt">&lt;plugin.source.version&gt;</span>3.1.0<span class="nt">&lt;/plugin.source.version&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>fr.vsct.tock<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>tock-bot-api-websocket<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${lib.tock.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>

    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;sourceDirectory&gt;</span>${project.build.sourceDirectory}<span class="nt">&lt;/sourceDirectory&gt;</span>
        <span class="nt">&lt;testSourceDirectory&gt;</span>${project.build.testSourceDirectory}<span class="nt">&lt;/testSourceDirectory&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.jetbrains.kotlin<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>kotlin-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>${plugin.kotlin.version}<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;executions&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;id&gt;</span>compile<span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;phase&gt;</span>compile<span class="nt">&lt;/phase&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>compile<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;id&gt;</span>test-compile<span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;phase&gt;</span>test-compile<span class="nt">&lt;/phase&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>test-compile<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;/executions&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>maven-source-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>${plugin.source.version}<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;executions&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;id&gt;</span>attach-sources<span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;phase&gt;</span>verify<span class="nt">&lt;/phase&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>jar-no-fork<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;/executions&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>


<blockquote>
<p>Vous pouvez retrouver ce code (et d'autres exemples) dans le dépôt <a href="">tock-bot-samples</a>.</p>
</blockquote>
<h2 id="creer-une-fonction-qui-se-connecte-a-tock">Créer une fonction qui se connecte à Tock<a class="headerlink" href="#creer-une-fonction-qui-se-connecte-a-tock" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Créez un fichier Kotlin (par exemple dans `src/main/kotlin/StartWebSocket.kt)</p>
</li>
<li>
<p>Editez-le avec le code suivant :</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">fr.vsct.tock.bot.api.client.newBot</span>
<span class="k">import</span> <span class="nn">fr.vsct.tock.bot.api.client.newStory</span>
<span class="k">import</span> <span class="nn">fr.vsct.tock.bot.api.websocket.startWithDemo</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">startWithDemo</span><span class="p">(</span> <span class="c1">// Integrate with the Tock demo platform by default</span>
        <span class="n">newBot</span><span class="p">(</span>
            <span class="s">&quot;PUT-YOUR-TOCK-APP-API-KEY-HERE&quot;</span><span class="p">,</span> <span class="c1">// Get your app API key from Bot Configurations in Tock Studio</span>
            <span class="n">newStory</span><span class="p">(</span><span class="s">&quot;qui-es-tu&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Answer for the &#39;qui-es-tu&#39; story</span>
                <span class="n">send</span><span class="p">(</span><span class="s">&quot;Je suis un assistant conversationnel construit avec Tock&quot;</span><span class="p">)</span>
                <span class="n">end</span><span class="p">(</span><span class="s">&quot;Comment puis-je aider ?&quot;</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">}</span>
</pre></div>


<blockquote>
<p>Vous pouvez retrouver ce code (et d'autres exemples) dans le dépôt <a href="">tock-bot-samples</a>.</p>
</blockquote>
<ul>
<li>
<p>Remplacez la clef d'API par celle de votre propre application Tock. Pour cela, dans <em>Tock Studio</em>, 
allez dans <em>Configuration</em> &gt; <em>Bot Configurations</em> et reportez la valeur <em>API Key</em> dans le code.</p>
</li>
<li>
<p>Exécutez la fonction (<em>main</em>) dans votre environnement de développement. Vous devriez voir apparaître une ligne 
de log ressemblant à celle-ci :</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><span class="o">[</span><span class="n">main</span><span class="o">]</span><span class="w"> </span><span class="n">INFO</span><span class="w">  </span><span class="n">fr</span><span class="p">.</span><span class="n">vsct</span><span class="p">.</span><span class="n">tock</span><span class="p">.</span><span class="n">bot</span><span class="p">.</span><span class="n">api</span><span class="p">.</span><span class="n">websocket</span><span class="p">.</span><span class="n">BotApiWebSocketClient</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="n">web</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="p">...</span><span class="err">}</span><span class="w"></span>
</pre></div>


<blockquote>
<p>Vérifiez éventuellement que d'autres logs provenant de <code>BotApiWebSocketClient</code> n'indiquent pas d'erreur. Si c'est le cas,
il peut s'agir d'une erreur de configuration de la clef d'API.</p>
</blockquote>
<h2 id="terminer-la-configuration-dans-tock-studio">Terminer la configuration dans <em>Tock Studio</em><a class="headerlink" href="#terminer-la-configuration-dans-tock-studio" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Retournez dans Tock et allez dans <em>Build</em> &gt; <em>Search Stories</em></p>
</li>
<li>
<p>Décochez l'option <em>Only Configured Stories</em>. Vous voyez alors tous parcours, y compris "qui-es-tu" que vous venez de 
déclarer programmatiquement</p>
</li>
<li>
<p>Allez dans <em>Test</em> &gt; <em>Test the bot</em> et saisissez une ou plusieurs phrases comme "qui es-tu ?" par exemple.
Vous contastez que le bot ne répond pas encore à cette question - il répond peut-être même à une autre 
intention. Il reste en effet une configuration à effectuer pour que la <em>qualification</em> fonctionne.</p>
</li>
</ul>
<p>A ce stade, le parcours existe bien dans Tock, mais l'<em>intention</em> n'a pas été créée automatiquement.
Vous pouvez le vérifier en regardant la liste des intentions disponibles dans <em>NLU</em> &gt; <em>Intents</em> &gt; <em>build</em> 
(la catégorie par défaut).</p>
<blockquote>
<p>TODO : fix <a href="https://github.com/voyages-sncf-technologies/tock/issues/533">#533</a></p>
</blockquote>
<ul>
<li>
<p>Allez dans <em>NLU</em> &gt; <em>Inbox</em>, pour la dernière phrase que vous venez de saisir :</p>
<ul>
<li>
<p>Changez l'intention pour <em>New intent</em></p>
</li>
<li>
<p>Nommez-la "qui-es-tu" comme dans le code (pour que le lien se fasse)</p>
</li>
<li>
<p>Créez l'intention avec <em>Create</em></p>
</li>
<li>
<p>Puis terminez la qualification de la phrase avec <em>Validate</em></p>
</li>
</ul>
</li>
<li>
<p>Si vous avez saisi d'autres phrases pour cette intention, pour chacune d'elles sélectionnez l'intention dans la 
liste puis confirmez avec <em>Validate</em></p>
</li>
<li>
<p>Retournez dans <em>Test</em> &gt; <em>Test the bot</em>. Si vous reposez la question, le bot vous donne désormais la réponse 
construite dans le code Kotlin (ie. "Je suis un assistant...").</p>
</li>
</ul>
<h2 id="felicitations">Félicitations!<a class="headerlink" href="#felicitations" title="Permanent link">&para;</a></h2>
<p>Vous venez de configurer votre première <em>story</em> programmatique en Kotlin.</p>
<p>De cette manière, vous pouvez tirer pleinement parti des possibilités d'un langage de programmation pour 
construire toutes sortes de parcours simples et complexes, interroger des API tierces, implémenter des 
 règles de gestion, etc.</p>
<blockquote>
<p>Si vous programmez ainsi une <em>story</em> déjà définie dans <em>Tock Studio</em>, c'est la définition présente dans <em>Tock Studio</em> 
qui est utilisée pour construire les réponses à l'exécution.</p>
</blockquote>
<h2 id="continuer">Continuer...<a class="headerlink" href="#continuer" title="Permanent link">&para;</a></h2>
<p>Dans la section suivante vous apprendez à :</p>
<ul>
<li><a href="../plateforme/">Déployer une plateforme Tock</a> en quelques minutes avec Docker</li>
</ul>
<p>Pour en savoir plus sur l'utilisation de <em>Tock Bot API</em> en mode <em>WebSocket</em>, mais aussi les autres 
modes de déploiement, les types de messages supportés par Tock, etc. vous pouvez consulter le
 <a href="../../toc/">manuel utilisateur</a>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../messenger/" title="Configurer Messenger" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Précédent
                </span>
                Configurer Messenger
              </span>
            </div>
          </a>
        
        
          <a href="../plateforme/" title="Déployer avec Docker" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Suivant
                </span>
                Déployer avec Docker
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017/2019 VSCT
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/voyages-sncf-technologies/tock" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c648116f.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../../assets/javascripts/lunr/lunr.fr.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>